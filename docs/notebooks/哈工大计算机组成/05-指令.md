# 指令

> 指令是什么，完成一个功能的命令，指令是软件与硬件之间的桥梁

## 概念

指令是执行计算机某种操作的命令

### 分类

层次上指令划分

- 微指令：微程序命令，属于硬件
- 宏指令：若干条机器指令组成，属于软件（一段程序）
- 机器指令：介于前两者之间，每条指令可以完成独立的算数运算和逻辑运算操作

### 指令系统

一台计算机中所有机器指令的集合被称为指令系统

### 发展

1. 20世纪50年代：只能定点运算，逻辑运算，数据传输，转移等几十个
2. 60年代：乘除，浮点
3. 70年代：复杂指令系统的出现：CISC，和精简指令系统的出现：RISC。

## 指令的性能

### 完备性

一套指令系统中必须有必不可少的指令

### 有效性

### 规整性

- 对称性匀齐性
- 一致性

### 兼容性

## 指令格式

> 指令需要做什么操作，需要什么操作，结果送到哪里，下一条指令从哪里取

指令格式包括两个部分即操作码字段OP+地址码字段A

### 操作码

以OP表示，这条指令进行什么操作，如加减乘除，每一种编码代表一种指令，且每个指令的op位数必须满足**N<=2^n**N为指令位数，n为op位数，在指令系统种op字段的长度一般是固定的，虽然这种行为会导致信息冗余极大。

### 地址码

根据指令中有几个操作数的地址，可称为几操作数指令或几地址指令

- 三地址指令：被操作数，操作数，操作结果

  操作码-A1-A2-A3：(A1)OP(A2)->A3

  - op：操作码
  - A1：被操作数地址
  - A2：操作数地址
  - A3：存放结果地址

- 二地址指令：双操作数

  操作码-A1-A2：(A1)OP(A2)->A1

  - op：操作码
  - A1：被操作数地址，存放结果地址
  - A2：操作数地址

  二地址根据操作数的物理地址分为

  - SS-存储器-存储器类型
  - RR-寄存器-寄存器类型（速度快）
  - SR-存储器-寄存器类型

- 单地址指令：操作数

- 零地址指令：只有操作码

### 指令字长度

- 指令字长：一个指令字包含的二进制代码位数
- 机器字长：**计算机能够直接处理的二进制数据的位数**
- 单字长指令：指令字长度=机器字长
- 半字长指令：指令字长度=机器字长*1/2
- 双字长指令：指令字长度=机器字长*2

#### 多字长指令

- 优点：提供足够的地址位来解决访问内存单元的寻址问题
- 缺点：降低运算速度

#### 等长指令

- 优点：字结构简单

#### 非等长指令

- 优点：结构灵活
- 缺点：控制复杂

## 指令和数据的寻址

> 存储器既可以存数据又可以存指令
>
> 存储单元的编号是该操作数或指令在存储器的地址

### 寻址方式

- 地址指令方式
- 相联存储方式
- 堆栈存取方式

采用地址指定方式时，形成操作数或指令地址方式，在内存中**指令寻址**与**数据寻址**是交替进行的

### 指令寻址方式（简单）

#### 寻址方式

- 顺序寻址方式：按照指令地址从小到大一个个顺序进行，一条指令接着一条指令顺序执行

  指令按照顺序排序，程序根据指示寻找顺序执行

- 跳跃寻址方式：程序转移执行顺序的时候指令的寻址就采用跳跃寻址方式，采用指令跳跃寻址可以实现程序的转移或构建循环程序

  **JMP（跳跃）**上会有一个指令的地址，这个地址会送往计数器，使其替换指令地址，然后根据这个新的指令地址来进行执行。

#### 操作数基本寻址

指令中的操作数字段的地址码是由形式地址和变址，间址组合形成的，所以其寻址

**操作数的寻址概括为：根据间址，变址组合变为操作数有效地址过程**

- 形式地址：偏移量，指令字结构中给定的地址量

- 寻址方式特征位：由间址和变址组成

- 有效地址（**目标**）：对于形式地址进行一定计算而得到的操作数实际地址（**操作数到底存储在哪里**）由寻址方式和形式地址共同确定

#### 隐含寻址

> 操作数的地址不明显给出，在指令中隐含着操作数的地址（**一地址**）

如AND 0FH，把累加器AC的内容与立即数0FH相**与**

#### 立即寻址

所需操作数由指令部分直接给出，操作数包含在指令内，所以我们取指令的时候可以被立即取出，**速度非常快**，但是指令字长度有限，其操作数的位数限制了所表示数的范围，寻址方式灵活性**最差**

#### 直接寻址

指令中地址码字段给出的地址A就是操作数的有效地址，且其操作数的地址是无法修改的，所以又叫**绝对寻址**

ADD AX [1000H]  —— （AX）+（1000H）—》AX

1000H地址指向存储器（主存中）的地址，所以由于需要直接进行**访问内存的操作**，所以大大降低了指令的执行速度

#### 间接寻址

指令中地址码字段给出的地址A就是操作数的**操作数地址指示器**（有点像相对和绝对的关系寻址）

访问两边主存，速度大大**降低**，但是**优点是可以灵活修改指示器，不必修改指令**

间接和直接寻址可以由**操作码后的I进行区分** 当I=0为直接寻址，I=1为间接寻址

#### 寄存器寻址

> 指令的操作数存放在相应的寄存器中

ADD AX BX **RR型指令**

由于寄存器在cpu内部，所以直接在寄存器中取出比访问主存快的多，而且寄存器的数量较小，占位少，所以有效减少**指令的地址码字段的长度**

#### 寄存器间接寻址

操作数在主存储中，操作数地址放在某一通用寄存器中，指令的地址码部分给出该通用的寄存器编号，实现**间接寄存器寻址**

指令较短，取值后需要进行访存才能得到操作数，执行速度慢一些，是目前计算机使用的**主要使用寻址方式**

#### 偏移寻址

由程序计数器PC提供基准地址，指令的地址码部分由给出的相对位移量A，两者相加后作为操作数的有效地址




### 数据寻址方式（复杂）



## 堆栈寻址方式



